(function(d,h){if(!d){return}var h=h||{};h.validate={};var k;h.validate.email=function(m){var l=/^[0-9a-zA-Z][_.0-9A-Za-z-]{0,31}@([0-9A-Za-z][0-9A-Za-z-]{0,30}\.){1,4}[A-Za-z]{2,4}$/;return d.trim(m.val()).match(l)};h.validate.phone=function(m){var l=/^1[3,4,5,7,8]\d{9}/;return d.trim(m.val()).match(l)};h.validate.qq=function(l){var m=/^[0-9]{1,}$/;return d.trim(l.val()).match(m)};h.validate.oldpassword=function(m){var l=/^.{6,20}$/;var n=m.parents("form").attr("id");h.validate[n+"password"]=m.val();return d.trim(m.val()).match(l)};h.validate.password=function(n){var m=/^.{6,20}$/;var o=n.parents("form").attr("id");h.validate[o+"password"]=n.val();var l=n.parents("form").find('[validate="repassword"]').size();if(l!=0){if(h.validate[o+"repassword"]&&(h.validate[o+"password"]!=h.validate[o+"repassword"])){h.validate.validRepassword(o)}if(h.validate[o+"password"]==h.validate[o+"repassword"]){h.validate.validRepassword(o)}}return d.trim(n.val()).match(m)};h.validate.repassword=function(l){var m=l.parents("form").attr("id");h.validate[m+"repassword"]=l.val();if(h.validate[m+"password"]==h.validate[m+"repassword"]){return true}else{return false}};h.validate.postalcode=function(l){var m=/^[1-9][0-9]{5}$/;return d.trim(l.val().match(m))};h.validate.yzm=function(m){var l=/^.*$/;return d.trim(m.val()).match(l)};h.validate.username=function(l){var m=/^[a-zA-Z0-9]{6,20}$/;return d.trim(l.val()).match(m)};h.validate.realname=function(l){var m=/^[A-Za-z\u4E00-\u9FA5]{1,30}$/;return d.trim(l.val()).match(m)};h.validate.cardnum=function(m){var l=/^.*$/;return d.trim(m.val()).match(l)};h.validate.cardId=function(l){return c(d.trim(l.val()))};h.validate.address=function(m){var l=/^[a-zA-Z\d\u4e00-\u9fa5]+$/;return d.trim(m.val()).match(l)};h.validate.nickname=function(m){var l=/^[A-Za-z\u4E00-\u9FA5]+$/;return d.trim(m.val()).match(l)};h.validate.noNull=function(l){return c(l.val())};h.validate.istel=function(m){var l=/^[\d\+\-\(\)]*$/;return d.trim(m.val()).match(l)};h.validate.config={email:{empty:"请输入邮箱账号",err:"您输入的邮箱有误",remoteerr:"您输入的邮箱已存在"},phone:{empty:"请输入手机号码",err:"您输入的手机号码格式有误",remoteerr:"您输入的手机号码已存在"},oldpassword:{empty:"请输入您的旧密码",err:"密码格式不正确"},password:{empty:"请输入您的密码",err:"密码格式不正确"},repassword:{empty:"请再次输入您的密码",err:"两次密码不一致"},yzm:{empty:"请输入验证码",err:"验证码有误",remoteerr:"已经失效"},username:{empty:"请输入您的用户名",err:"用户名格式有误"},account:{},realname:{empty:"请输入您的真实姓名",err:"姓名格式有误"},nickname:{empty:"请输入您的昵称",err:"昵称格式有误"},address:{empty:"请输入您的地址",err:"地址格式有误"},cardnum:{empty:"请输入证件号码",err:"证件号码格式有误"},postalcode:{empty:"请输入邮政编码",err:"邮政编码有误"},sex:{empty:"请选择性别"},istel:{empty:"传真号码不能为空",err:"传真号码格式有误"},qq:{empty:"请选择",err:"qq格式不正确"},read:{empty:"请阅读注册协议并勾选"},cardId:{empty:"请选择证件类型",err:"证件号码格式有误"},yearold:{empty:"请选择生日"}};h.validate.message=function(s,q,n,m,r){var p=d("#"+s+' input[validate="'+n+'"]');var l=d("#"+s+" ."+n+"txt");if(m){p.addClass("m-member-orange");if(l.size()==0){if(r=="groupvalidate"||n=="yzm"){q.parent().append('<span class="'+n+'txt m-notice m-err errclass"><i></i>'+h.validate.config[s][n][m]+"</span>")}else{p.after('<span class="'+n+'txt m-notice m-err errclass"><i></i>'+h.validate.config[s][n][m]+"</span>")}}else{l.show().html("<i></i>"+h.validate.config[s][n][m])}}else{p.removeClass("m-member-orange");l.hide();if(k.showCorrectHint){var o=q.siblings(".icon-checked-m");if(o.length===0){o=d('<span class="icon icon-checked-m"></span>');q.last().after(o)}o.css("display","inline-block")}}};h.validate.init=function(p){var o=p.formid;var l=p.config;k=p;h.validate.config[o]=d.extend({},h.validate.config,l,{formId:o});var o=h.validate.config[o].formId;var n=true;var m=false;d("#"+o+" .txt").hide();h.validate.validRepassword=function(q){d("#"+q+' input[validate="repassword"]').blur()};h.validate.init.submit=function(v){var s=v;var r=false;var u=[];d("#"+s+" input[validate]").each(function(){var w=d(this);if(w.attr("type")=="text"||w.attr("type")=="password"){d(this).siblings(".txt").hide();w.blur();var x=w.data("remote");if(x&&x.readyState!=4){u.push(x);d(document).ajaxComplete(t)}}});d("#"+s+" [groupvalidate]").each(function(){var C=d(this);var D=C.attr("groupvalidate").split("@");var A=D[0];var z=D[1];if(A=="radio"||A=="checkbox"){var x=d(this).find("input:checked").size()>0?0:1}if(A=="select"){var w=d(this).find("select").length;var x=0;for(var y=0;y<w;y++){var B=d(this).find("select").eq(y);if(B.val()==""||!B.val()||B.val()==="0"){x=1;break}}}g(s,d(this).children(),z,x,"groupvalidate")});d("#"+s+" select[validate]").each(function(){var y=d(this);var x=y.attr("validate");var w;if(!y.val()&&y.attr("rel-required")){w=1}else{w=0}g(s,d(this),x,w,"")});if(u.length==0){return q()}function q(){if(d("#"+s+" .errclass:visible").size()>0){m=false}else{m=true}return m}function t(x,y,w){u.splice(u.indexOf(y),1);if(u.length==0){if(d("#"+s+" .errclass:visible").size()>0){m=false}else{m=true}}}};d("#"+o+' select[validate="cardtype"]').change(function(){if(d("#"+o+' [validate="cardnum"]').val()!=""){d("#"+o+' [validate="cardnum"]').blur()}else{d("#"+o+' [validate="cardnum"]').parent().find("input").removeClass("m-member-orange")}});d("#"+o+' input:not([type="submit"])').on("blur",function(r){var q=d(this).attr("validate");d(this).siblings(".txt").hide();g(o,d(this),q,f(d(this),r),"")});d("#"+o+" input").on("focus",function(){d(this).siblings(".m-err").hide();d(this).siblings(".txt").show()})};function g(p,n,m,l,o){switch(l){case 1:h.validate.message(p,n,m,"empty",o);break;case 2:h.validate.message(p,n,m,"err",o);break;case 3:h.validate.message(p,n,m,"remoteerr",o);break;case 0:h.validate.message(p,n,m,"",o)}}function f(m,n){var l=a(m.attr("validate"),m);if(l==0&&m.attr("checkPath")){b(m)}return l}function b(o){if(o.attr("checkPath")){var m;var n=o.attr("checkPath");var l=o.data("remote");if(l&&l.readyState!=4){o.data("remote").abort()}o.data("remote",d.ajax({type:"POST",url:n+"?d="+new Date().getMilliseconds(),data:{parm:o.val()},success:function(q){m=Number(q)==0?0:3;var r=d(o).parents("form").attr("id");var p=d(o).attr("validate");g(r,d(o),p,Number(m),"")}}))}}function a(p,l){if(p){var o=j(l);if(o==0){if(l.attr("depend")){var n=l.attr("depend");var m=l.parents("form").attr("id");p=Number(d("#"+m+' [validate="'+n+'"]').val());p=p==110001?"cardId":"cardnum"}if((!l.attr("rel-required")&&d.trim(l.val())=="")||h.validate[p](l)){return 0}else{return 2}}else{return o}}return 0}function j(l){if(l.attr("rel-required")){if(d.trim(l.val())==""){return 1}else{return 0}}return 0}function c(n){var m=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1);var q;var t=new Array();var l;var v=0;var s;var p=n.length;var u=n;if((p!=15)&&(p!=18)){return false}for(i=0;i<p;i++){t[i]=u.charAt(i);if((t[i]<"0"||t[i]>"9")&&(i!=17)){return false}else{if(i<17){t[i]=t[i]*m[i]}}}if(p==18){var o=u.substring(6,14);if(e(o)==false){return false}for(i=0;i<17;i++){v=v+t[i]}s=12-v%11;switch(s){case 10:s="X";break;case 11:s=0;break;case 12:s=1;break}if(t[17].toUpperCase()!=s){return false}}else{var r=u.substring(6,12);if(e(r)==false){return false}}return true}function e(l){return true}(function(l){this.browser={version:(l.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(l),opera:/opera/.test(l),msie:/msie/.test(l)&&!/opera/.test(l),mozilla:/mozilla/.test(l)&&!/(compatible|webkit)/.test(l)}})(navigator.userAgent.toLowerCase());d("input.m-member").on("focus",function(){d(this).addClass("m-member-focus")});d("input.m-member").on("focusout",function(){d(this).removeClass("m-member-focus")})})(jQuery,window.ECar||(window.ECar={}));