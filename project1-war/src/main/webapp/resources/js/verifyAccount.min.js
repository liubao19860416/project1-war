var account=function(){var j=$(".account"),l=j.siblings(".m-err"),c=l.find(".errTxt"),m={mobile:"手机号",email:"邮箱",username:"用户名"},d=null,b=false;j.on("focus",function(){l.hide();j.removeClass("m-member-orange")});var k={basicRule:/^[a-zA-Z0-9@]*$/,mobile:/^1[3,4,5,7,8]\d{9}$/,onlyNum:/^[0-9]*$/,email:/^[0-9a-zA-Z][_.0-9A-Za-z-]{0,31}@([0-9A-Za-z][0-9A-Za-z-]{0,30}\.){1,4}[A-Za-z]{2,4}$/};var f="没有这个用户哦，再想想～～";j.on("blur",i);function i(){var n;var o=j.val();if(o.match(k.mobile)){n="mobile"}else{if(k.email.test(o)){n="email"}else{if(o.length===0){h(f)}else{if(!(k.basicRule.test(o))){h(f)}else{if(o.length<6||o.length>20){h(f)}else{if(k.onlyNum.test(o)&&!k.mobile.test(o)){h(f)}else{if(o.indexOf("@")!==-1&&k.email.test(o)){h(f)}else{n="username"}}}}}}}d=n?m[n]:null;a(n);return e(n,o)}function g(){return b}function a(n){b=!!n}function h(n){c.html(n);l.show();j.addClass("m-member-orange")}function e(o,n){if(o){j.removeClass("m-member-orange");return $.ajax({url:base+"/account/findPassWord/userIsExist.htm",dataType:"JSON",data:{userName:n},type:"POST",success:function(q){var p=q.isExist,r=q.msg;if(p==="0"){a(true)}else{a(false);h(r)}},error:function(){a(true)}})}}return{$input:j,state:g,validate:i}}();var $picCapcha=$(".yzm");var capcha=function(){var e=$("#indentycode"),b=e.siblings(".m-err"),c=b.find(".errTxt"),d=false;function a(){return d}e.on("blur",function(){if($.trim(e.val()).length===0){c.text("验证码一定要填写喔");b.show();e.addClass("m-member-orange");d=false}else{d=true}});e.on("focus",function(){b.hide();e.siblings("#codeMsg").hide();e.removeClass("m-member-orange")});return{$input:e,state:a}}();var $submitBtn=$("#submit"),$form=$("#form4"),validateItems=[capcha];function submitValidate(a){return function(){$.each(validateItems,function(){this.$input.trigger("blur")});var b=true;if(!account.state()){b=false}$.each(validateItems,function(){if(this.state()===false){b=false;return false}});if(b){$form.submit()}else{a.preventDefault()}}}$submitBtn.on("click",function(b){var a=account.validate();if(a){a.always(submitValidate(b))}else{submitValidate(b)()}});