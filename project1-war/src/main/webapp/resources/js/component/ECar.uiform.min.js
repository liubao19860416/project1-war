(function(){if(ECar.uiform){return}ECar.uiform=function(){var d,e=$(arguments[0]);d=$.extend({},this.defaults,arguments[arguments.length-1]);this.init(e,d)};ECar.uiform.prototype={defaults:{selectClass:"form-select",selectHoverClass:"",selectIgnoreFirstOption:true,inputCheckboxClass:"form-checkbox",inputCheckboxHoverClass:"",inputRadioClass:"form-radio",inputRadioHoverClass:"",selectMaxHeight:200,selectOptionShowSpeed:100,checkboxClass:"form-checkbox"},init:function(e,d){this.options=d;e.find("input:text, input:password, textarea").focus(function(){$(this).addClass("focus")}).blur(function(){$(this).removeClass("focus")});if(e.is("form")){e=e.find("select,:radio,:checkbox")}e.each(function(){var f=$(this),g;if(f.is("select")){new a(this,d)}else{if(f.is(":checkbox")){new b(this,d)}else{if(f.is(":radio")){new c(this,d)}}}})}};function a(f,l){var f=this.dom=$(f),j=this.ui=$("<div>").addClass(l.selectClass).css("float",f.css("float")),i=this.handle=$("<span>").addClass("form-select-handle").appendTo(j),k=this.label=$("<span>").appendTo(i),h=this.triangle=$("<i>").appendTo(i),d=this.optionWrapper=$("<div>").addClass("form-select-options").appendTo(j),e=this.optionScroller=$("<div>").addClass("form-select-scroll").appendTo(d),g=this.option=$("<ul>").appendTo(e);l=this.options=l,this.prompt=f.data("title");this.scroller=null;j.insertAfter(f);f.css("position","absolute").css("visibility","hidden").appendTo(j);this.render();i.bind("click",(function(m){return function(n){if(!m.isDisabled()){m.isOpen()?m.close():m.open()}}})(this));f.bind("update",(function(m){return function(n){m.render()}})(this)).bind("change",(function(m){return function(n){m.change()}})(this));d.on("click","li",(function(m){return function(n){m.select(n.target);m.label.removeClass("form-select-unselected")}})(this));$(document.body).on("click",(function(m){return function(n){if(!$.contains(m.ui[0],n.target)){m.close()}}})(this))}a.prototype={render:function(){var k=this.option,o=this.label,l=this.handle,j=this.triangle,f=this.optionWrapper,n=this.ui,i=this.dom,h=this.options,g=this.optionScroller;this.scroller=null;k.empty();o.empty();g.removeAttr("style");g.removeClass("scroll-wrapper");k.removeClass("scroll-content");g.find(">.scrollbar").remove();var d=$(document.createDocumentFragment());var q=i.find("option"+(h.selectIgnoreFirstOption?":gt(0)":"")+"").each(function(){var s=$(this),t=s.text(),r=s.val(),p=$("<li>").data("value",r).text(t);d.append(p);if(s.prop("selected")){o.text(t);p.addClass("form-option-selected")}});n.width(i.outerWidth());f.width(n.width());k.width(f.width());g.width(k.width());var m=j.outerWidth()+parseInt(j.css("marginRight"))+parseInt(j.css("right"))+15+5;o.width(n.width()-m);if(o.text()===""){o.text(this.prompt||i.find("option").first().text()).addClass("form-select-unselected")}else{o.removeClass("form-select-unselected")}d.appendTo(k);var e=f.parent();f.appendTo(document.body);if(h.selectMaxHeight&&f.height()>h.selectMaxHeight){g.height(h.selectMaxHeight);g.addClass("scroll-wrapper");k.addClass("scroll-content");$('<div class="scrollbar"><div class="scrollbar-narrow scrollbar-narrow-up"></div><div class="scrollbar-bg"><div class="scrollbar-handler"><div class="scrollbar-handler-top"></div><div class="scrollbar-handler-bottom"></div></div></div><div class="scrollbar-narrow scrollbar-narrow-down"></div></div>').appendTo(g);this.scroller=ECar.imitatescroll({id:g})}f.appendTo(e)},select:function(d){var d=$(d),e=d.data("value");this.dom.val(e).trigger("change");this.close()},change:function(){var e=this.dom.find("option:selected"),g=e.val(),d,f=this;this.label.text(e.text());d=$.grep(this.option.find("li").toArray(),function(h){return $(h).data("value")==g});this.option.find(".form-option-selected").removeClass("form-option-selected");$.each(d,function(){$(this).addClass("form-option-selected")})},open:function(){var d=this.handle,e=this.optionWrapper,f=$(window);if(d.hasClass("form-select-expand")){return}if(!this.scroller){this.scroller=ECar.imitatescroll({id:this.optionScroller})}this.scroller.reset();e.css("visibility","hidden").show();if(f.height()-(d.offset().top+Math.min(d.height(),this.options.selectMaxHeight)-f.scrollTop())<e.height()){e.addClass("form-select-options-above")}else{e.removeClass("form-select-options-above")}e.css("visibility","hidden").hide();e.css("visibility","visible");e.slideDown(this.options.selectOptionShowSpeed,(function(g){return function(){g.scroller&&g.scroller.reset()}})(this));d.addClass("form-select-expand");this.dom.trigger("select.open",[this.dom])},close:function(){var d=this.handle,e=this.optionWrapper;if(!d.hasClass("form-select-expand")){return}e.slideUp(this.options.selectOptionShowSpeed);d.removeClass("form-select-expand")},isOpen:function(){return this.handle.hasClass("form-select-expand")},isDisabled:function(){return this.dom.prop("disabled")}};function b(h,e){var h=this.dom=$(h),g=this.ui=$("<div>").addClass(e.checkboxClass).css("float",h.css("float")),f=this.handle=$("<div>").addClass("form-checkbox-inner").appendTo(g);g.insertAfter(h);h.hide().appendTo(g);h.bind("change",(function(i){return function(){i.update()}})(this));g.click((function(i){if(/MSIE\s[7|8]./.test(navigator.appVersion)){return function(j){j.stopPropagation();i.dom[0].click()}}else{return function(){h.trigger("change")}}})(this));if(/MSIE\s[7|8]./.test(navigator.appVersion)){var d=h.parents("label");if(h.attr("id")){d.add($("label[for="+h.attr("id")+"]"))}d.click((function(i){return function(){i.dom[0].click()}})(this))}if(h.prop("checked")){h.triggerHandler("change")}}b.prototype={update:function(){var e=this.dom,d=this.handle;(e.prop("checked")?d.addClass:d.removeClass).call(d,"form-checkbox-checked")}};function c(e,d){}})(jQuery,window.ECar||(window.ECar={}));