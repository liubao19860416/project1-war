(function(b,a){if(a.seriesSelect){return}var c={url:"",selects:[],nodata:"none",required:false,complete:b.noop,data:null};a.seriesSelect=function(o,r){if(o.length<1){return}var i=b.extend(true,{},c,r);if(!i.selects.length){return}var n=o;var k=[];var m=i.selects.length;var f;var p;var e=function(s){return(i.required)?s:s-1};var h=function(u,v){var t=v||"请选择";var s;if(!i.required){s="<option value='0'>"+t+"</option>"}b.each(u,function(w,x){if(!x.value){s+="<option value='"+x.text+"'>"+x.text+"</option>"}else{s+="<option value='"+x.value+"'>"+x.text+"</option>"}});return s};var l=[];function g(u){var t=u.children("option");var s=[];for(var v=0,w=t.length;v<w;v++){s.push(t.eq(v).text())}return s}var q=function(){for(var s=0;s<m;s++){k.push(n.find("select."+i.selects[s]))}p=h(f,k[0].data("title"));k[0].html(p);k[0].trigger("update");for(var s=0;s<m;s++){if(k[s].data("val")){l.push(s)}else{if(k[s].attr("disabled")){if(i.nodata=="none"){k[s].css("display","none")}else{if(i.nodata=="hidden"){k[s].css("visibility","hidden")}}}}}n.on("change","select",function(){j(this.className)});d()};var d=function(t){if(!l.length){i.complete(f);return}var s=t||0;if(s<l.length){setTimeout(function(){var u=k[s].data("val");k[s].val(u);if(k[s].val()==u){k[s].trigger("change")}s++;d(s)},1)}else{i.complete(f)}};var j=function(s){var x=[];var v;var u;var w;for(var t=0;t<m;t++){x.push(e(k[t].get(0).selectedIndex));if(v||t>v){k[t].empty().attr("disabled",true);k[t].trigger("update");if(i.nodata=="none"){k[t].css("display","none")}else{if(i.nodata=="hidden"){k[t].css("visibility","hidden")}}}if(s.indexOf(i.selects[t])>-1){v=t;k[v].trigger("update")}}u=v+1;w=f;for(var t=0;t<u;t++){if(typeof(w[x[t]])=="undefined"||!w[x[t]].children||!w[x[t]].children.length){return;break}w=w[x[t]].children}if(k[u]){p=h(w,k[u].data("title"));k[u].html(p).attr("disabled",false);k[u].trigger("update")}colorArray={child:[]};for(t=0;t<w.length;t++){colorArray.child.push(w[t])}k[v].trigger("selectChange.extra",colorArray)};if(i.url){b.getJSON(i.url,function(s){f=s;q()})}else{if(i.data){f=i.data;q()}}}})(jQuery,window.ECar||(window.ECar={}));