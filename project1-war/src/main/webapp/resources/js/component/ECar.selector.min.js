(function(b,a){a.selector=function(){this.init.apply(this,arguments)};a.selector.prototype={defaults:{dom:null,handler:">:first-child",label:">:first-child>:first-child",dropdown:">:nth-child(2)",openClass:"expand",selectedClass:"selected"},init:function(){var c=this.options,e=this.defaults,d=this;if(b.isPlainObject(arguments[0])){c=b.extend({},e,arguments[0])}else{c=b.extend({},e,{dom:arguments[0]})}this.settings=c;var f=this.dom=b(c.dom);f.attr("tabIndex",100);this.handler=b(c.handler,f);this.label=b(c.label,f);this.dropdown=b(c.dropdown,f).hide();this.prompt=f.attr("data-prompt");this.options=this.dropdown.find("a");this.label.text(this.prompt);this.opened=false;this.handler.click(function(){if(!d.opened){b(document.body).trigger("click");d.open()}else{d.close()}});f.click(function(g){g.stopPropagation()});this.dropdown.on("click","a",function(h){var g=b(h.currentTarget),i=d.settings.selectedClass;d.dom.find("li."+i).removeClass(i);g.parent().addClass(i);d.select(g);d.close();h.preventDefault()})},val:function(){if(arguments.length==1){var c=this,d=arguments[0];this.options.each(function(f,g){var e=b(g);if(e.attr("data-value"==d)){c.select(e);return false}})}else{return this.dom.attr("data-value")}},select:function(d){var e=this.dom.attr("data-value"),g=d.attr("data-id"),c=this.label.text(),f=d.text();if(e==g&&c==f){return}this.dom.attr("data-value",d.attr("data-id"));this.label.text(d.text());this.dom.trigger("change")},open:function(){var c=this;this.dropdown.slideDown(100);this.dom.addClass(this.settings.openClass);this.opened=true;b(document.body).one("click",function(){c.close()})},close:function(){if(!this.opened){return}this.dropdown.slideUp(100);this.dom.removeClass(this.settings.openClass);this.opened=false},reset:function(){this.label.text(this.dom.attr("data-prompt"));this.dom.attr("data-value","");this.dropdown.find("li").removeClass(this.settings.selectedClass)}};b.fn.ecarSelector=function(){this.each(function(c,d){d.selector=new a.selector(d)});return this}})(jQuery,window.ECar||(window.ECar={}));