(function(b,a){(function(c){if(!c){return}c.extend(String.prototype,{sliceBefore:function(d){return(this.indexOf(d)>=0)?this.substring(0,this.indexOf(d)):this.toString()},substitute:function(d){if(d&&typeof(d)=="object"){return this.replace(/\{([^{}]+)\}/g,function(e,f){var g=d[f];return(g!==undefined)?""+g:""})}else{return this.toString()}}})})(jQuery);(function(c){if(!c){return}if(!window.ECar){window.ECar={}}a.namespace=function(f,e){var g=f.split(e||"."),i={},h=function(j,d,k){if(k<d.length){if(!j[d[k]]){j[d[k]]={}}i=j[d[k]];h(j[d[k]],d,k+1)}};h(window,g,0);return i};a.timestat={};a.timestat.libs={};a.timestat.loadTime=(typeof(_ECar_page_loadtime)=="number")?_ECar_page_loadtime:new Date().getTime();a.timestat.add=function(d){this.libs[d]=new Date().getTime()-this.loadTime};a.timestat.get=function(d){return this.libs[d]||0};a.lang={};a.lang.language="zh-cn";a.lang.text={};a.lang.get=function(e,d){if(d){if(this.text[e]){return this.text[e][d]||""}else{return""}}else{return this.text[e]||null}};a.lang.set=function(f,d,e){if(!this.text[f]){this.text[f]={}}if(e){this.text[f][d]=e}else{this.text[f]=d}};a.lang.extend=function(e,d){if(!this.text[e]){this.text[e]={}}c.extend(this.text[e],d)}})(jQuery);(function(c){if(!c||!window.ECar){return}a.namespace("ECar.page");a.page.keyHandler={};a.page.keyHandler.events={};a.page.keyHandler.keys={ESC:27,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,TOP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};a.page.keyHandler.add=function(g,d,e,f){this.events[e]=function(j){try{var i=j.which||j.keyCode||0;if(i==a.page.keyHandler.keys[d]){f()}}catch(h){}};c(g).bind("keydown",this.events[e])};a.page.keyHandler.remove=function(e,d){c(e).unbind("keydown",this.events[d]);this.events[d]=null}})(jQuery);(function(c){if(!c||!window.ECar){return}a.namespace("ECar.utilStyles");c.extend(a.utilStyles,{"util-overlayer":"z-index:9000;display:none;width:100%;height:100%;position:absolute;top:0;left:0;right:0;bottom:0;","util-recyclebin":"position:absolute;top:-10000px;left:-10000px;width:1000px;height:1000px;overflow:hidden;"});a.namespace("ECar.util");a.recyclebin={};a.recyclebin.id="util-recyclebin";a.recyclebin.container=c("#util-recyclebin");a.recyclebin.init=function(){if(c("#"+this.id).size()==0){this.container=c('<div id="'+this.id+'" style="'+a.utilStyles[this.id]+'"></div>');c("body").append(this.container)}};a.recyclebin.add=function(d){this.container.append(d)};a.recyclebin.find=function(d){return(this.container.children("#"+d).size()>0)?true:false};a.recyclebin.clear=function(){this.container.html("")};a.overlayer={};a.overlayer.id="util-overlayer";a.overlayer.status=false;a.overlayer.showLayer=function(e,d){if(this.status){return false}e=(typeof(e)!="undefined")?e:0.5;d=d||"#000";if(c("#"+this.id).length==0){c("body").append('<div id="'+this.id+'" style="'+a.utilStyles[this.id]+'"></div>')}c("#"+this.id).css({background:d,filter:("alpha(opacity="+e*100+")"),opacity:e});this.setSize();this.status=true};a.overlayer.hideLayer=function(){if(this.status){c("#"+this.id).fadeOut();this.status=false}};a.overlayer.setSize=function(){c("#"+this.id).css({width:"100%",height:c(document).height()+"px",display:"block"})};a.overlayer.resize=function(){if(this.status){c("#"+this.id).css("display","none");this.setSize()}};c(window).resize(function(){a.overlayer.resize()});a.timestat.add("load-util-overlayer")})(jQuery);(function(d){if(!d||!window.ECar){return}a.namespace("ECar.util");if(a.dialog){return}var c="c-dialog";var e=a.lang.get(c)||{close:"关闭",closeTips:"关闭浮层",loading:"正在加载中……",loadingError:"加载失败",confirm:"确定",cancel:"取消",alertTitle:"消息提示",confirmTitle:"确认提示",promptTitle:"输入提示"};e.id=c;a.dialog={};a.dialog.id=c;a.dialog.status=false;a.dialog.resizeStatus=false;a.dialog.finishCallback=null;a.dialog.closeCallback=null;a.dialog.tmpls={frameset:['<div id="{id}">','<div class="pdb-bgm"></div>','<div class="pdb-main">','<div class="pdb-title"><h4></h4><div class="border-out"><p class="border-in"><span class="close icon icon-close" onclick="ECar.dialog.close();" title="{closeTips}">{close}</span></p></div></div>','<div class="pdb-content"><div class="pdb-contentframe"></div></div>','<div class="pdb-bottom"></div>',"</div>","</div>"].join(""),titletab:'<span data-url="{url}" data-width="{width}" data-height="{height}">{title}</span>',bottom:'<p class="pdb-bottom-action"><a class="dialog-btn btn-action"><em>{confirm}</em></a><a class="dialog-btn btn-cancel"><em>{cancel}</em></a></p><p class="pdb-bottom-text"></p>',loading:'<p class="txt-loading-32" style="margin-top:{marginTop}px;">{loadingText}</p>',alert:'<div class="msg-{type} f14">{message}</div><div class="tac pb20"><a class="dialog-btn btn-cancel btn-ok" onclick="ECar.dialog.close();"><em>确定</em></a></div>',confirm:'<div class="msg-confirm f14">{message}</div>',prompt:'<div class="p20 f14">{content}</div>',inputelm:'<dl class="prompt clearfix"><dt>{title}</dt><dd><input type="text" class="txt-input" /></dd></dl>',iframe:'<iframe id="{iframeId}" name="{iframeId}" src="about:blank" width="100%" height="{height}px" scrolling="auto" frameborder="0" marginheight="0" marginwidth="0"></iframe>',error:'<div class="p20"><p class="txt-error">{loadingError}</p></div>',ajaxload:'<p class="txt-loading-32" style="margin-top:{height}px;">&nbsp;</p>'};a.dialog.init=function(){if(d("#"+this.id).size()==0){d("body").append(this.tmpls.frameset.substitute(e));this.container=d("#"+this.id)}};a.dialog.open=function(h){if(this.status&&this.lastContentId){d("body").append(d("#"+this.lastContentId));d("#"+this.lastContentId).hide();this.lastContentId=null}a.overlayer.showLayer(h.op,h.overbg);this.init();this.options=h;if(h.callback){this.finishCallback=h.callback}if(h.closeFunction){this.closeCallback=h.closeFunction}if(h.title){this.container.find(".pdb-title").show();this.setTitle(h.title,h.tabs)}else{this.container.find(".pdb-title").hide()}if(h.bottom){this.container.find(".pdb-bottom").show();this.setBottom(h.bottom)}else{this.container.find(".pdb-bottom").hide()}var i=h.width||400;var f=h.height||300;var k=this;switch(h.mode||"text"){case"ajax":var j=this.container.find(".pdb-contentframe");d.ajax({type:h.content.type||"get",url:h.content.url,data:h.content.param||"",error:function(){k.setContent(h.content.error||k.tmpls.error.substitute(e));k.setAutoHeight(60);k.finish()},success:function(l){k.setContent(l);setTimeout(function(){k.setAutoHeight()},100);h.ajaxComplete&&h.ajaxComplete.call(k)},beforeSend:function(n,l){var m=k.tmpls.ajaxload.substitute({height:(f-32)/2});j.html(h.content.loading||m);k.setAutoHeight()}});break;case"text":this.setContent(h.content);break;case"id":this.setContent("");d("#"+h.id).appendTo("#"+this.id+" .pdb-contentframe");d("#"+h.id).removeClass("hidden").show();this.lastContentId=h.id;break;case"iframe":this.iframeId="iframe_"+(new Date()).getTime();this.setContent(this.tmpls.iframe.substitute({iframeId:this.iframeId,height:f}));this.setIframe(h.url);break}this.container.find(".pdb-main").css("width",i+"px");this.container.find(".pdb-content").css("height",f+"px");this.container.css("width",i+8+"px").show();var g=f+((h.title)?this.container.find(".pdb-title").height():0)+((h.bottom)?55:0);this.container.find(".pdb-bgm, .pdb-main").css("height",g+"px");this.container.attr("class",h.css||"");this.status=true;this.resizeStatus=true;this.resize();if(h.mode!="ajax"){this.finish()}if(h.supportESC!==false){a.page.keyHandler.add(document,"ESC","esc-dialog",function(){a.dialog.close()})}this.handlePopupCloseButton(h.closeButtonOn)};a.dialog.handlePopupCloseButton=function(f){var g=d("#c-dialog .border-out");if(g.length){if(f===false){g.hide()}else{g.show()}}};a.dialog.finish=function(){if(this.finishCallback){this.finishCallback(this.container.find(".pdb-contentframe"))}};a.dialog.resize=function(){if(this.status&&this.resizeStatus){var f=(d(window).width()-this.container.width())/2;var g=(this.options.top)?this.options.top:(d(window).height()-this.container.height())/2;this.container.css({left:d(document).scrollLeft()+Math.max(f,20)+"px",top:d(document).scrollTop()+Math.max(g,20)+"px"});if(d.browser.isIE6){this.container.bindECarUI("HideOverElements","select,object")}}};a.dialog.close=function(f){if(!this.status){return}switch(f){case"fade":this.container.fadeOut();break;case"slide":this.container.slideUp();break;default:this.container.hide()}a.overlayer.hideLayer();this.status=false;if(this.lastContentId){d("body").append(d("#"+this.lastContentId));d("#"+this.lastContentId).hide();this.lastContentId=null}if(d.browser.isIE6){this.container.bindECarUI("ShowOverElements","select,object")}if(this.closeCallback){setTimeout(function(){a.dialog.closeCallback();a.dialog.closeCallback=null},0)}a.page.keyHandler.remove(document,"esc-dialog")};a.dialog.setCloseCallback=function(f){if(Object.prototype.toString.call(f)!=="[object Function]"){return}this.closeCallback=f};a.dialog.setTitle=function(j,g){var h=this.container.find(".pdb-title h4");if(g){h.addClass("tab").html("");for(var f=0;f<g.length;f++){h.append(this.tmpls.titletab.substitute(g[f]))}h.find("span:first").addClass("on");h.find("span").click(function(){if(d(this).hasClass("on")){return}d(this).siblings(".on").removeClass("on");d(this).addClass("on");a.dialog.setIframe(d(this).attr("data-url"));a.dialog.setWidth(parseInt(d(this).attr("data-width")));a.dialog.setHeight(parseInt(d(this).attr("data-height")))})}else{h.removeAttr("class").html(j)}};a.dialog.setStyle=function(f){if(f.titlecolor){this.container.find(".pdb-title").css("color",f.titlecolor)}if(f.bgcolor){this.container.find(".pdb-title").css("background-color",f.bgcolor)}if(f.bordercolor){this.container.find(".pdb-main").css("border-color",f.bordercolor)}};a.dialog.setContent=function(f){this.container.find(".pdb-contentframe").html(f)};a.dialog.setIframe=function(f){d("#"+this.iframeId).attr("src",f)};a.dialog.setBottom=function(f){if(!f){return}if(f.html){this.container.find(".pdb-bottom").html(f.html)}else{this.container.find(".pdb-bottom").html(this.tmpls.bottom.substitute(e));if(f.noteHtml){this.container.find(".pdb-bottom .pdb-bottom-text").html(f.noteHtml)}if(f.actionHTML){this.container.find(".pdb-bottom .pdb-bottom-action").html(f.actionHTML)}else{if(f.actionBtnText){this.container.find(".pdb-bottom .btn-action em").html(f.actionBtnText)}if(f.cancelBtnText){this.container.find(".pdb-bottom .btn-cancel em").html(f.cancelBtnText)}}}if(f.callback){this.container.find(".pdb-bottom .btn-action").click(function(){f.callback()})}else{this.container.find(".pdb-bottom .btn-action").click(function(){a.dialog.close()})}if(f.cancel){this.container.find(".pdb-bottom .btn-cancel").click(function(){f.cancel()})}else{this.container.find(".pdb-bottom .btn-cancel").click(function(){a.dialog.close()})}};a.dialog.setWidth=function(f){if(!f){return}var f=parseInt(f);this.container.find(".pdb-main").css("width",f+"px");this.container.css("width",(f+8)+"px");this.resize()};a.dialog.setHeight=function(f){if(!f){return}var f=parseInt(f);var h=this.container.find(".pdb-content").height();var g=this.container.find(".pdb-main").height();this.container.find(".pdb-bgm, .pdb-main").css("height",(f-h+g)+"px");this.container.find(".pdb-content").css("height",f+"px");this.container.find(".pdb-content iframe").attr("height",f);this.resize()};a.dialog.setAutoHeight=function(g){var f=Math.max(d(".pdb-contentframe").height(),g||100);this.setHeight(f)};a.dialog.showLoading=function(f){f.mode="text";f.height=100;f.marginTop=(f.height-56)/2;f.loadingText=f.loadingText||e.loading;f.content=this.tmpls.loading.substitute(f);this.open(f);return false};a.dialog.show=function(f){f.mode="id";this.open(f);this.setAutoHeight();return false};a.dialog.pop=function(f){f.mode="iframe";this.open(f);return false};a.dialog.ajax=function(f){f.mode="ajax";f.content={url:f.url};this.open(f);return false};a.dialog.alert=function(g){if(typeof(g)=="string"){g={message:g}}g.close=e.close;g.type=g.type||"alert";var f=this.tmpls.alert.substitute(g);this.open({mode:"text",title:g.title||e.alertTitle,content:f,width:g.width||350,height:100,top:g.top,closeFunction:g.callback});this.setAutoHeight();return false};a.dialog.confirm=function(h){if(typeof(h)=="string"){h={message:h}}var g=this.tmpls.confirm.substitute(h);var i=function(){a.dialog.close();if(h.callback&&d.isFunction(h.callback)){h.callback()}};var f=function(){a.dialog.close();if(h.cancel&&d.isFunction(h.cancel)){h.cancel()}};this.open({mode:"text",title:h.title||e.confirmTitle,css:h.css,content:g,bottom:{callback:i,cancel:f},width:h.width||350,height:60,top:h.top});this.setAutoHeight(60);return false};a.dialog.prompt=function(k){if(!d.isArray(k.message)){k.message=[k.message]}var j=[];for(var f=0;f<k.message.length;f++){j.push(this.tmpls.inputelm.substitute({title:k.message[f]}))}var h=this.tmpls.prompt.substitute({content:j.join("")});var l=function(){var i=[];a.dialog.container.find("dl.prompt input").each(function(){i.push(d(this).val().trim())});k.callback(i);a.dialog.close()};var g=function(){a.dialog.close()};this.open({mode:"text",title:k.title||e.promptTitle,content:h,bottom:{callback:l,cancel:g},width:k.width||350,height:60,top:k.top});this.setAutoHeight(60);return false};d(window).resize(function(){a.dialog.resize()});a.timestat.add("load-util-dialog")})(jQuery)})(jQuery,window.ECar||(window.ECar={}));