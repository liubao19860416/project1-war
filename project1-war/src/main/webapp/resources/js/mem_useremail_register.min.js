(function(a){window.chageCodeImage=function(b){document.getElementById(b).src=base+"/account/validateCode.htm?d="+new Date().getTime()};a(function(){a('#register-infor [validate="password"]').keyup(function(m){var n=window.event||m;pwdCheck.init(n,a(this).val(),a(".register-infor .pwdline"))}).trigger("keyup");a(".remember .check").toggle(function(){a(this).removeClass("ticks");a(".remember .checkbox").attr("checked",false);a(".remember").find("span.m-err").show()},function(){a(this).addClass("ticks");a(".remember .checkbox").attr("checked",true);a(".remember").find("span.m-err").hide()});a('[for="ifRemenberMe"]').click(function(){a(".remember .check").click()});var g=a("input[name='userNameType']");a("input.excluded").off();var f=function(){var x=a(".account"),A=x.closest("dd").children(".m-err"),p=A.find(".errTxt"),o=x.closest("dd").children(".icon-checked-m"),B={email:"邮箱",username:"用户名"},q=null,n=false;x.on("focus",function(){A.hide();o.hide();x.removeClass("m-member-orange")});var y={basicRule:/^[a-zA-Z0-9@]*$/,onlyNum:/^[0-9]*$/,email:/^[0-9a-zA-Z][_.0-9A-Za-z-]{0,31}@([0-9A-Za-z][0-9A-Za-z-]{0,30}\.){1,4}[A-Za-z]{2,4}$/};x.on("blur",w);function w(){var C;var D=x.val();if(y.email.test(D)){C="email"}else{if(D.length===0){v("车享账号一定要填写喔")}else{if(!(y.basicRule.test(D))){v("用户名只可以用数字和字母喔")}else{if(D.length<6||D.length>20){v("账号需要6-20位长哟")}else{if(y.onlyNum.test(D)){v("用户名不能是纯数字")}else{if(D.indexOf("@")!==-1&&!y.email.test(D)){v("您输入的邮箱地址有误喔，检查一下吧")}else{C="username"}}}}}}q=C?B[C]:null;m(C);r(C);s(C);return t(C,D)}function z(C){if(C){o.show()}}function u(){return n}function m(C){n=!!C}function s(C){switch(C){case"mobile":g.val(1);break;case"email":g.val(2);break;case"username":g.val(3);break}}function r(C){if(C=="mobile"){b.hide()}else{b.show()}}function v(C){p.html(C);A.eq(0).show().siblings(".m-err").hide();x.addClass("m-member-orange")}function t(D,C){if(D){x.removeClass("m-member-orange");return a.ajax({url:base+"/account/userIsExist.htm",dataType:"JSON",data:{userName:C,userNameType:g.val()},type:"POST",success:function(G){var F=G.isExist;if(F==="0"){o.show();m(true)}else{if(F==="1"){var E=a("#backUrl").val();v("您输入的"+q+'已被注册过啦，<a href="'+base+"/account/login.htm?backUrl="+E+'">点此直接登录</a>吧!');m(false);if(q==="手机号"){}}else{if(F==="2"){var E=a("#backUrl").val();var H=base+"/account/m_presendEmailagain.htm?email="+C+"&backUrl="+E;v('您的邮箱处于未激活状态哟，<a href="'+H+'">点此重发验证邮件</a>吧!');m(true)}}}},error:function(){}})}}return{$input:x,state:u,validate:w}}();var k=(function(){var s=a("input[validate='password']"),q=s.siblings(".tip"),v=s.siblings(".m-err"),m=v.find(".errTxt"),o=s.siblings(".icon-checked-m"),n=false;s.on("focus",function(){q.text("您需要输入6-20位字符哟，使用字母、数字或符号组合更安全").show();v.hide();o.hide();s.removeClass("m-member-orange")});s.on("blur",t);function t(){q.hide();var w=p();if(!w.ok){m.text(w.message);v.show();s.addClass("m-member-orange");n=false}else{if(w.message){q.text(w.message).show()}else{o.show()}n=true}if(e.$input.val()){e.$input.trigger("blur")}}var u={allNumber:/^[0-9]{6,20}$/};function r(){return n}function p(){var w={ok:true,message:null};var x=s.val();if(x.length===0){w.ok=false;w.message="不要心急哟，密码还空着呐"}else{if(x.length<6||x.length>20){w.ok=false;w.message="密码需要6-20位长哟"}else{if(u.allNumber.test(x)){w.ok=true;w.message="密码还可以再复杂一些喔，如字母+数字的组合，这样账号安全性会大大提升"}else{w.ok=true;w.message=null}}}return w}return{$input:s,state:r,validate:t}})();var e=(function(){var s=a("input[validate='repassword']"),q=s.siblings(".tip"),u=s.siblings(".m-err"),m=u.find(".errTxt"),o=s.siblings(".icon-checked-m"),n=false;function r(){return n}s.on("focus",function(){q.text("再次核对您的密码喔").show();u.hide();o.hide();s.removeClass("m-member-orange")});s.on("blur",t);function t(){q.hide();var v=p();if(!v.ok){m.text(v.message);u.show();s.addClass("m-member-orange");n=false;o.hide()}else{u.hide();n=true;o.show();s.removeClass("m-member-orange")}}function p(){var v={ok:true,message:null};var w=s.val();if(w.length===0){v.ok=false;v.message="不要心急哟，确认密码还空着呐"}else{if(a("input[validate='password']").val()!=w){v.ok=false;v.message="您两次输入的密码不一致喔"}else{v.ok=true;v.message=null}}return v}return{$input:s,state:r,validate:t}})();var b=a(".yzm");var i=function(){var r=a("#codeId"),n=r.siblings("#emailErr"),o=n.find(".errTxt"),p=false;function m(){return p}r.on("blur",q);function q(){if(a.trim(r.val()).length===0){o.text("哎呀，验证码好像不正确");n.show();r.addClass("m-member-orange");p=false}else{p=true}}r.on("focus",function(){n.hide().siblings(".m-err").hide();r.siblings("#codeMsg").hide();r.removeClass("m-member-orange")});return{$input:r,state:m,validate:q,showWrongMsg:function(s){o.text(s);n.show();r.addClass("m-member-orange")}}}();var h=function(){var p=a("#ifRemenberMe"),n=false;function m(){return n}function o(){if(!p.attr("checked")){n=false}else{n=true}}p.blur(o);return{$input:p,state:m,validate:o}}();var j=a(".registerbut .btn"),l=a("#register-infor");var c=[f,k,e,i,h];j.on("click",function(){validation=[];a.each(c,function(){validation.push(this.validate())});a.when.apply(null,validation).done(function(){var m=true;a.each(c,function(){if(this.state()===false){m=false;return false}});if(m){l.submit()}})});var d=g.val();if(d=="1"){a(".yzm").hide();a(".sms").show()}ECar.placeholder(a(".account"))})})(jQuery);